try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}var app=window.app||{};baidu.object.extend(app,{www_domain:"http://www.baidu.com",apps_domain:"http://app.baidu.com",search_url:"http://open.baidu.com/appstore/s",url_contact_html:"http://app.baidu.com/static/appweb/scripts/aladdin/app_contact.html"});app.log=function(){};app.init_comment=function(b){var a=baidu.dom.q("app-info-comment")[0];var c=new Comment(b,a);c.get_data=function(d,f){dal.comments(d,b.app_id,function(g){c.data=g;f&&f()})};c.init()};app.widget={Filtrator:function(c,a){var b=this;b.element=c;b.items={};b.init=function(){var f=function(){};a=baidu.extend({onselect:f,ondelete:f},a);var d=baidu.array.unique(a.data||[]);baidu.each(d,function(g,h){b.addItem(g)})};b.hasItem=function(d){return(d in b.items)};b.removeItem=function(d){baidu.dom.remove(b.items[d]);delete b.items[d]};b.addItem=function(g){if(!b.hasItem(g)){var f=document.createElement("span");f.className="app-w-filtrator-span";var d='<span class="app-w-filtrator-text">#{text}</span><span class="app-w-filtrator-close"></span>';f.innerHTML=baidu.format(d,{text:baidu.string.encodeHTML(g.length>6?(g.substr(0,5)+"..."):g)});f.title=g;c.appendChild(f);b.items[g]=f;f.onmouseover=function(){baidu.addClass(this,"app-w-filtrator-span-hover")};f.onmouseout=function(){baidu.removeClass(this,"app-w-filtrator-span-hover")};baidu.Q("app-w-filtrator-close",f)[0].onclick=function(){if(a.ondelete.call(b,g)===false){return}b.removeItem(g)};baidu.Q("app-w-filtrator-text",f)[0].onclick=function(){a.onselect.call(b,g)}}};b.getWords=function(){var f=[];for(var d in b.items){f.push(d)}return f};b.init()}};var dal=app.dal={_query_cache:{},_build_url:function(c,b){var a=[];for(param in c){a.push(param+"="+encodeURIComponent(c[param]))}if(a.length>0){b+="?"}return b+a.join("&")},_get:function(params,url,onsuccess){var query=dal._build_url(params,url);if(query in dal._query_cache){app.log("dal._get query cache hit "+query);onsuccess(dal._query_cache[query])}else{baidu.ajax.get(query,function(xhr,responseText){var response_data=eval("("+responseText+")");dal._query_cache[query]=response_data;onsuccess(response_data)})}},_sync_get:function(params,url){var query=dal._build_url(params,url);if(query in dal._query_cache){app.log("dal._get query cache hit "+query);return dal._query_cache[query]}else{baidu.ajax.request(query,{async:false,onsuccess:function(xhr,responseText){var response_data=eval("("+responseText+")");dal._query_cache[query]=response_data}});return dal._query_cache[query]}},_load_script:function(f,b,g){if(dal._no_cache){f._t=+new Date();dal._no_cache=false}var d=dal._build_url(f,b);var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.type="text/javascript";if(d.indexOf(app.search_url)==0){a.charset="gbk"}else{a.charset="utf-8"}app.log("_load_script: charset",a.charset);a.src=d;a.onload=a.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){g&&g();a.onload=a.onreadystatechange=null;if(c&&a.parentNode){c.removeChild(a)}}};c.insertBefore(a,c.firstChild)},send:function(a,d,c,f){var b=arguments.callee;window[c]=function(g){if(g.errno=="1"){app.login(function(){b(a,d,c,f)})}else{if(g.errno=="10"){app.fillinusername(function(){b(a,d,c,f)})}else{f(g)}}};dal._load_script(d,a)},comments:function(b,a,c){app.log("dal.comments");dal.send(app.apps_domain+"/store/comment",{appid:a,pn:b,ps:Comment.PageSize,t:+new Date()},"app_comment_callback",c)},getvcode:function(a){dal.send(app.apps_domain+"/vcode/getvcode",{callback:"app_comment_vcode",t:+new Date()},"app_comment_vcode",a)},contact:function(b,c){var a={appid:b.app_id,from_name:b.from_name,from_mail:b.from_mail,subject:b.subject,text_body:b.text_body,captcha:b.captcha,vcode:b.vcode};dal.send(app.apps_domain+"/app/contact/developer",a,"app_contact_callback",c);app.log("dal.contact data:",a)},submit_comment:function(a,b){dal.send(app.apps_domain+"/store/comment/submit",{appid:a.appid,content:a.content,score:a.score,captcha:a.captcha,vcode:a.vcode,ie:"utf8"},"app_submit_comment_callback",b)},unauthorize:function(a,b){dal.send(app.apps_domain+"/app/unauthorize",{appid:a,t:+new Date()},"app_unauthorize_callback",b);app.log("dal.unauthorize appid",a)},addedkeywords:function(a,b){dal.send(app.apps_domain+"/store/rest/getserver",{m:"getAddedWords",appid:a,t:+new Date},"app_getAddedWords_callback",b);app.log("dal.addedkeywords app_id:",a)},rmWord:function(a,b,c,d){dal.send(app.apps_domain+"/store/rest/updateserver",{m:"rmWord",appid:a,bdstoken:b,word:c,t:+new Date},"app_rmWord_callback",d);app.log("dal.rmWord")},addwords:function(a,b,c,d){dal.send(app.apps_domain+"/store/rest/updateserver",{m:"addWords",appid:a,keywords:c,bdstoken:b,t:+new Date},"app_addWords_callback",d)},app_detail:function(a){dal._load_script({appid:a,t:+new Date()},app.apps_domain+"/app/info")},app_info:function(a,b){dal.send(app.apps_domain+"/app/info",{appid:a,t:+new Date()},"app_detail_callback",b)},add_app:function(a,c,b,f){var d={m:"addFav",tn:"rest_update_appweb",tpl:"rest_update_appweb",appid:a,bdstoken:c,t:+new Date()};if(b){d.w=b}dal.send(app.apps_domain+"/store/rest/updateserver",d,"app_addFav_callback",f)},del_app:function(a,b,d){var c={m:"rmFav",tn:"rest_update_appweb",tpl:"rest_update_appweb",appid:a,bdstoken:b,t:+new Date()};dal.send(app.apps_domain+"/store/rest/updateserver",c,"app_rmFav_callback",d)}};app.show_added_ok_tip=function(){var a=['<div class="add-ok-tips">应用已经收藏成功，','您可以到<a target="_blank" href="',app.apps_domain,'/appweb/mine">我的应用中心</a>和登录后的<a href="http://www.baidu.com/">百度首页</a>进行编辑。</div>','<div class="clearfix" style="margin-bottom:25px;"><span style="float:left;margin-top:25px;">将自己喜欢的应用也分享给朋友：</span>'+window.__share__text+"</div>"].join("");app.tip("收藏成功！",a,false,{width:474});window.shareInit&&window.shareInit()};app.collect=function(b,i){var f={"-1003":"当前关键词关联的应用超过限制","-1004":"关键词字符长度超过限制","-1005":"您已经添加过这个应用了","1000":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1001":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1002":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1003":"该应用正在维护"};function h(){if(i.is_added){baidu.dom.addClass(b,"selected");b.getElementsByTagName("a")[0].style.paddingLeft="22px"}else{baidu.dom.removeClass(b,"selected");b.getElementsByTagName("a")[0].style.paddingLeft="28px"}b.getElementsByTagName("span")[0].innerHTML=i.is_added?"已收藏":"收藏"}function a(){dal.add_app(i.app_id,i.bdstoken,"",function(k){if("-1005"==k.errno||"0"==k.errno){i.is_added=true;h();app.show_added_ok_tip()}else{f[k.errno]&&app.alert(f[k.errno])}})}var j=false;var g=null;var c={width:200,height:"auto",zIndex:900,autoRender:true,modal:false,resizable:false,autoOpen:false,autoDispose:false,draggable:true,coverable:true,contentText:'<div class="app-tip">确定要取消收藏？</div>',onclose:function(){j=false}};function d(){j=true;var k=baidu.dom.getPosition(b);baidu.extend(c,{top:k.top-112,left:k.left-70,buttons:{accept:{content:'<a href="javascript:void(0);" class="tips-button tips-button-green-short">确定</a>',onclick:function(n){var m=this,l=m.getParent();dal.del_app(i.app_id,i.bdstoken,function(o){if("-1005"==o.errno||"0"==o.errno){i.is_added=false;h()}else{f[o.errno]&&app.alert(f[o.errno])}});l.dispatchEvent("onaccept")&&l.close()}},cancel:{content:'<a href="javascript:void(0);" class="tips-button tips-button-gray-short">取消</a>',onclick:function(n){var m=this,l=m.getParent();l.dispatchEvent("oncancel")&&l.close()}}}});if(g){g.update(c)}else{g=new baidu.ui.Dialog(c)}g.open()}baidu.on(window,"resize",function(){if(j){var k=baidu.dom.getPosition(b);g.update({top:k.top-112,left:k.left-70})}});baidu.on(b,"click",function(k){i.is_added?d():a();baidu.event.preventDefault(k)});h();return{add_app:a,del_app:d}};app.show_add_dialog=function(i,g,f){var d=[];var a=i.is_added;if(app.keyword){d.push(baidu.string.encodeHTML(app.keyword))}d.push(i.app_name);d=d.concat(i.category);d=baidu.array.unique(d);app.log("recommend_words",d);var b=[];baidu.each(d,function(x,w){b.push('<a href="javascript:;" class="app-tip-recommend-word">',x,"</a>")});var q=app.tip(a?"编辑收藏信息":"收藏设置","","add",g);var p=baidu.Q("app-tip-msg",q.getContent())[0];p.innerHTML=["<table>","<tr><th>标签：</th><td>",'<input type="text" maxlength="500" class="app-tip-keyword-input inset-shadow" value="" />',a?'<button class="tips-button tips-button-green-short app-tip-add-button">添加</button>':"",'<div class="app-tip-add-tip" style="display:none;clear:both;">搜索词不能为空</div>',"</td></tr>",'<tr class="app-tip-added-keywords-row">',"<th>已添加：</th>",'<td><div class="app-tip-added-keywords"></div></td>',"</tr>","<tr>",'<th>推荐：</th><td><div class="app-tip-keyword-select">',b.join(""),"</div></td>","</tr>","</table>",'<div class="app-tip-help-text">','可添加多个，逗号分隔，每个不超过30个字符。您也可以到<a target="_blank" href="',app.apps_domain+"/appweb/mine/",'">我的应用中心</a>进行编辑',"</div>",'<div class="app-tip-btns">',a?"":'<button class="tips-button tips-button-green-short app-tip-add-submit">收藏</button>','<button class="tips-button tips-button-gray-short app-tip-add-cancel">',a?"关闭":"取消","</button>","</div>"].join("");var t=",";var n=baidu.Q("app-tip-keyword-select",p)[0],h=baidu.Q("app-tip-added-keywords",p)[0],k=baidu.Q("app-tip-add-submit",p)[0],c=baidu.Q("app-tip-add-cancel",p)[0],j=baidu.Q("app-tip-keyword-input",p)[0],l=baidu.Q("app-tip-add-tip",p)[0],r=baidu.Q("app-tip-add-button",p)[0];if(a){var m=new app.widget.Filtrator(h,{data:i.added_keywords,ondelete:function(w){app.dal.rmWord(i.app_id,i.bdstoken,w,function(){m.removeItem(w);q.update()});return false}});dal.addedkeywords(i.app_id,function(w){baidu.each(w.keywords,function(x,y){m.addItem(x)});q.update()});r.onclick=function(){if(!s()){return false}var w=o();dal.addwords(i.app_id,i.bdstoken,w,function(x){if(x.errno=="0"){baidu.each(w.split(t),function(y,z){m.addItem(y)});q.update();j.value="";j.focus()}})}}else{baidu.hide(baidu.Q("app-tip-added-keywords-row",p)[0]);j.value=app.keyword||"";k.onclick=function(){if(!v()){return false}window.sendShareColl&&window.sendShareColl(g.fromShare);var w=o();dal.add_app(i.app_id,i.bdstoken,w,function(x){f&&f(x);q.close()})}}c.onclick=function(){q.close()};j.onfocus=function(){baidu.hide(l);q.update()};j.focus();q.update();var u=baidu.Q("app-tip-recommend-word",n);baidu.each(u,function(x,w){x.onclick=function(){var z=o();word=baidu.string.decodeHTML(x.innerHTML);var y=z.split(t);if(baidu.array.indexOf(y,word)==-1){if(z.length>0&&(z.lastIndexOf(t)!=(z.length-1))){word=t+word}j.value=z+word}j.focus();return false}});return q;function o(){var w=j.value.replace(/\uff0c/g,",").replace(/,+/g,",");j.value=w;return w}function s(){if(j.value==""){l.innerHTML="搜索词不能为空";baidu.show(l);q.update();return false}if(v()===false){return false}return true}function v(){var x=o().split(t);for(var w=0;w<x.length;w++){if(x[w].length>30){l.innerHTML="单个搜索词不能超过30个字符";baidu.show(l);q.update();return false}}return true}};app._tip_dialogs={};app.tip=function(l,d,k,a,b){var m={width:385,height:"auto",autoRender:true,modal:true,resizable:false,autoOpen:false,draggable:true,coverable:true,onclose:function(){}};baidu.extend(m,a);k=k||"success";var g=k=="success"||k=="fail";m.contentText=baidu.format('<div class="app-tip"><h2>#{title}</h2><div class="app-tip-msg">#{msg}</div>#{timer}</div>',{title:l,msg:d,timer:(g?'<div class="app-tip-close-text">本提示<span class="app-tip-time">10</span>秒后自动关闭</div>':"")});var j=new baidu.ui.Dialog(m);var i=j.getContent();baidu.addClass(i,"app-tip-"+k);j.open();if(g){var c=parseInt(b)||5,f=baidu.Q("app-tip-time",i)[0];var h;if(h){clearTimeout(h)}h=setTimeout(function(){f.innerHTML=c;if(c>0||!j||!j.isShown()){clearTimeout(h);h=setTimeout(arguments.callee,1000);c--}else{if(j&&j.isShown()){j.dispose()}}},1)}app._tip_dialogs[+new Date]=j;return j};app.alert=function(a){app.tip("操作失败",a,"fail")};app.contact={dialog:null,app_info:null,init:function(a){this.app_info=a;this.init_dialog()},init_dialog:function(){var b=this.dialog=app.tip("","","authorize",{modal:1});var d=appinfo_json.data;var c=baidu.Q("app-tip-msg",b.getContent())[0];var a=['<iframe src="',app.url_contact_html,'"',' class="app_authorize_iframe" frameborder="0"',' magrinheight="0" width="100%" marginwidth="0" border="0"></iframe>'].join("");c.innerHTML=a;b.update()},show_success:function(){this.dialog.close();var a=app.tip("信息发送成功",baidu.format("您的信息已发送给“#{app_name}”的#{developer_title}",this.app_info),"",{modal:1,top:(baidu.page.getScrollTop()+50+"px")})},fix_height:function(a){this.dialog.getContent().getElementsByTagName("iframe")[0].style.height=a+"px";this.dialog.update()}};app.authorize={dialog:null,confirm:function(b){var f=this.dialog=app.tip("","","authorize",{modal:1,width:490});var g=baidu.Q("app-tip-msg",f.getContent())[0];var d=['<div class="app-authorize-confirm-text">移除授权后，如果您要使用此应用需要再次授权</div>','<div class="app-authorize-confirm-buttons">','<button class="tips-button tips-button-green-short app-authorize-confirm-ok">移除</button>','<button class="tips-button tips-button-gray-short app-authorize-confirm-cancel">取消</button>',"</div>"].join("");g.innerHTML=d;f.update();var c=baidu.Q("app-authorize-confirm-ok",g)[0],a=baidu.Q("app-authorize-confirm-cancel",g)[0];baidu.event.on(c,"click",function(){dal.unauthorize(b,function(j){app.log(j);if(j.errno=="0"){var i=baidu.Q("app-tip-msg",f.getContent())[0];var h=['<div class="app-authorize-confirm-text">正在移除授权，请稍候...</div>'].join("");i.innerHTML=h;f.update();setTimeout(function(){f.close();window.location.reload()},1500)}else{f.close()}})});baidu.event.on(a,"click",function(){f.close()})}};app.donate={dialog:function(c){var a=baidu.format(['<div class="tips-content tips-content-donate">','<form class="app-donation-f" method="get" target="_blank" action="',app.apps_domain,'/store/donate">','<div class="app-icon"><img src="#{app_logo}" alt="#{app_name}" /><i class="app-single-round"></i></div>',"<p>应用名：#{app_name}</p>",'<p class="blue"><a target="_blank" href="#{developer_website}">#{developer_uname}</a></p>','<p>捐赠金额：<input type="text" name="money" class="text app-donation-value" /><span class="app-donation-price-text">元</span><span class="app-donation-tip" style="display:none;">提交金额超出范围</span></p>',"<p>支付方式：",'<label><input type="radio" checked="checked" name="pay_type" value="1" class="app_donation_ebank" />使用网银支付</label>','<label><input type="radio" name="pay_type" value="1" class="app_donation_baifubao" />使用百付宝余额支付</label>','<label><input type="radio" name="pay_type" value="2" class="app_donation_baidubi" />使用百度币支付</label>','<input type="hidden" name="pay_sub_type" class="app_donation_pay_sub_type" value="2" />','<input type="hidden" class="app-donation-appid" name="appid" value="#{app_id}" />','<input type="hidden" class="app-donation-bdstoken" name="bdstoken" value="#{bdstoken}" />',"</p></form></div>"].join(""),c);app.tip("捐赠",a,"donate",{width:540,buttons:{accept:{content:'<button class="tips-button tips-button-orange">捐赠 &gt;</button>',onclick:function(){var f=this,d=f.getParent();b()&&d.close()}}}});function b(){var g=baidu.dom.q("app-donation-value")[0],j=baidu.dom.q("app-donation-tip")[0];if(baidu.trim(g.value)==""||isNaN(Number(g.value))||Number(g.value)<0.1||Number(g.value)>10000){baidu.show(j);g.focus();return false}else{baidu.hide(j);var i=baidu.dom.q("app_donation_pay_sub_type")[0],k=baidu.dom.q("app_donation_ebank")[0],h=baidu.dom.q("app_donation_baifubao")[0],d=baidu.dom.q("app_donation_baidubi")[0],f=baidu.dom.q("app-donation-price-text")[0];if(k.checked){i.value="2"}else{if(h.checked){i.value="1"}else{i.value=""}}baidu.dom.q("app-donation-f")[0].submit();return true}}app.donate.init()},init:function(){var d=baidu.dom.q("app_donation_pay_sub_type")[0],g=baidu.dom.q("app_donation_ebank")[0],c=baidu.dom.q("app_donation_baifubao")[0],a=baidu.dom.q("app_donation_baidubi")[0],b=baidu.dom.q("app-donation-price-text")[0];var f={"1":"元","2":"百度币"};baidu.each([g,c,a],function(h,j){if(h){baidu.event.on(h,"click",function(){b.innerHTML=f[h.value]})}})}};app.developer={introduction:function(c,b){var a='<h3 class="tips-title">开发者简介</h3><div class="tips-content  tips-content-intro #{classname}">#{content}</div>';App.dialog(baidu.format(a,{name:appinfo_json.app_name,content:b,classname:((baidu.string.getByteLength(b)>700)?"tips-content-l9":"")}),{width:610,buttons:{accept:{content:'<a href="javascript:void(0);" class="tips-button tips-button-green">关闭</a>',onclick:function(g){var f=this,d=f.getParent();d.dispatchEvent("onaccept")&&d.close();baidu.event.stop(g)}}}})}};T.string.filterFormat.cut=function(a){return T.string.filterFormat.escapeString((a+"").substr(0,5))};app.relatedRecommend={init:function(a,b){if(baidu.g("RecList")){baidu.ajax.get("/appweb/recommended?appid="+a.app_id,function(f){var g=f.responseText;var c=(g.match(/rec[0-9]+rec/g)+"").replace(/[^0-9]/g,"")*1||83;window.related_rc_item_height=c;if(c<90){baidu.dom.addClass("RecList","one-in-one")}var d=Math.floor((appinfo_json.height-36)/c)*c;baidu.g("RecList").style.height=d+"px";baidu.g("RecListPar").style.height=d+"px";baidu.g("AppScoreList")&&(baidu.g("AppScoreList").style.height=Math.floor(d/32)*32+"px");baidu.g("RecList").getElementsByTagName("ul")[0].innerHTML=f.responseText;window.appRelatedBoxInit();b&&b()})}},build:function(c){if((c.total_count==0)||(c.errno!="0")){return""}var a='<li><dl class="app-single-item"><dt><a target="_blank" data-appid="#{app_id}" href="/app/enter?appid=#{app_id}"><img alt="#{app_name|escapeString}" src="#{app_logo}"></a><a target="_blank" data-appid="#{app_id}" href="/app/enter?appid=#{app_id}"><i title="#{app_name}" class="app-single-round"></i></a></dt><dd><a title="#{app_name}" target="_blank" class="app-name" data-item="title" data-appid="#{app_id}" href="/app/enter?appid=#{app_id}">#{app_name|cut}</a></dd></dl></li>';var b="";T.each(c.data,function(f,d){b+=T.string.filterFormat(a,f)});T.g("RecList").getElementsByTagName("ul")[0].innerHTML=b;baidu.show("Hot_Rec_Page");if(window.withoutRankList){appRelatedBoxInit()}}};window.app_getRelatedAppsList_callback=app.relatedRecommend.build;window.appRelatedBoxInited=false;window.appRelatedBoxInit=function(){if(baidu.g("RecList")){var b=T.g("RecList").getElementsByTagName("ul")[0];var a=b.offsetHeight;App.scrollWidget({previous:"AppRelPrevious",next:"AppRelNext",content:"RecList",direction:"vertical",offset:baidu.g("RecList").offsetHeight,method:"scrollTo",__height__:a});baidu.show("Hot_Rec_Page")}};app.score_standings={init:function(a){baidu.g("AppScoreList")&&baidu.ajax.get("/appweb/pk/top?app_id="+a.app_id+"&time="+(new Date().toString().replace(/(\s|:|\+)/g,"")),function(f){var b=f.responseText.replace(/\s/gi,"");var c=baidu.json.parse(b);if(c){app.score_standings.build(c)}})},build:function(d){var b='<li><span class="rank-num">#{num}</span><a href="#{bdspace_url}" title="#{name}" target="_blank"><img height="20" width="20" src="#{head_portrait}" alt="#{name}" /></a><a href="#{bdspace_url}" style="width:auto;" title="#{name}" target="_blank">#{shortName}</a><span class="rank-score" title="#{score}">#{shortScore}</span></li>';var c=[];var a=0;baidu.each(d,function(g,f){if(!g){return}g.num=f+1;if(g.scroe){g.score=g.scroe}if(parseInt(g.score)>9999999){g.shortScore=(""+g.score).substr(0,8);g.shortName=g.name.substr(0,2)}else{g.shortScore=g.score;g.shortName=g.name.substr(0,3)}c.push(baidu.format(b,g));try{if(bdUser){if(g.name.indexOf(bdUser)!=-1){a=f}}}catch(h){}});baidu.dom.removeClass("AppScoreList","app-score-stangdings-list-none");baidu.g("AppScoreList").innerHTML=baidu.format('<ol class="rank-list hot-app-rank">#{list}</ol>',{list:c.join("")});baidu.show(baidu.q("my-integral-rank-btn")[0]);App.scrollWidget({previous:"AppScorePrevious",next:"AppScoreNext",content:"AppScoreList",direction:"vertical",beginPos:a>0?a*30:0,offset:baidu.g("AppScoreList").offsetHeight,method:"scrollTo"})},update:function(b,a){app.score_standings.init(appinfo_json)}};window.app_score_standings_callback=app.score_standings.update;app.description=function(a){if(baidu.dom.q("intro")[0]){baidu.on(baidu.dom.q("intro")[0],"click",function(g){var d='<h3 class="tips-title">#{name}的简介</h3><div class="tips-content  tips-content-intro #{classname}">#{description}</div>#{imags}';var b="";var f=(baidu.string.getByteLength(a.description)>700)?"tips-content-l9":"";if(a.app_screenshot.length>0){var h='<div class="tips-images clearfix">#{0}</div>';var c='<img src="#{0}" alt="" />';baidu.each(a.app_screenshot,function(i){b+=baidu.format(c,i)});b=baidu.format(h,b);f="tips-content-l5"}App.dialog(baidu.format(d,{name:a.app_name,description:a.description,imags:b,classname:f}),{width:610,buttons:{accept:{content:'<a href="javascript:void(0);" class="tips-button tips-button-green">关闭</a>',onclick:function(k){var j=this,i=j.getParent();i.dispatchEvent("onaccept")&&i.close();baidu.event.stop(k)}}}});baidu.event.stop(g)})}};app.instruction=function(a){if(baidu.dom.q("play")[0]){baidu.on(baidu.dom.q("play")[0],"click",function(c){var b='<h3 class="tips-title">#{name}玩法介绍</h3><div class="tips-content  tips-content-intro #{classname}">#{instruction}</div>';App.dialog(baidu.format(b,{name:a.app_name,instruction:a.instruction,classname:((baidu.string.getByteLength(a.instruction)>700)?"tips-content-l9":"")}),{width:610,buttons:{accept:{content:'<a href="javascript:void(0);" class="tips-button tips-button-green">关闭</a>',onclick:function(g){var f=this,d=f.getParent();d.dispatchEvent("onaccept")&&d.close();baidu.event.stop(g)}}}});baidu.event.stop(c)})}};function Pager(b){var a=this;a.display_type="hide";a.prev=function(){if(a.current_page>1){a.current_page=a.current_page-1;a.on_change_page(a.current_page);a.update_state();app.log("Pager.prev() ",a.current_page)}};a.next=function(){if(a.current_page<a.total_page){a.current_page=a.current_page+1;a.on_change_page(a.current_page);a.update_state();app.log("Pager.next() ",a.current_page)}};a.change_page=function(c){c=parseInt(c);if(isNaN(c)){c=1}if(c<1){c=1}if(c>a.total_page){c=a.total_page}a.current_page=c;a.on_change_page(a.current_page);a.update_state();app.log("Pager.change_page() ",a.current_page)};a.num=function(d){var c=['<a class="item'];if(d==a.current_page){c.push(" current")}c.push('" href ="#app_comment">'+d+"</a>");return c.join("")};a.more=function(){return'<span class="app_pager_more">...</span>'}();a.update_state=function(){app.log("Pager.update_state() current_page:",a.current_page," total_page:",a.total_page);if(a.current_page==1){baidu.dom.addClass(a.prev_button,Pager.pager_end)}else{baidu.dom.removeClass(a.prev_button,Pager.pager_end)}if(a.current_page==a.total_page){baidu.dom.addClass(a.next_button,Pager.pager_end)}else{baidu.dom.removeClass(a.next_button,Pager.pager_end)}var d=[];if(a.total_page<=Pager.max){for(var c=1;c<=a.total_page;c++){d.push(a.num(c))}}else{d.push(a.num(1));if((a.total_page-a.current_page<4)&&(a.total_page>4)){d.push([a.more,a.num(a.total_page-4),a.num(a.total_page-3),a.num(a.total_page-2),a.num(a.total_page-1),a.num(a.total_page)].join(""))}else{if((a.current_page-3>=2)){d.push([a.more,a.num(a.current_page-1),a.num(a.current_page)].join(""))}else{d.push([a.num(2),a.num(3),a.num(4)].join(""))}if(a.total_page-a.current_page<4){for(var c=a.current_page+1;c<a.total_page;c++){d.push(a.num(c))}}else{var f=a.current_page;if(f<4){f=4}d.push([a.num(f+1),a.more].join(""))}a.current_page!=a.total_page?d.push(a.num(a.total_page)):""}}a.num_wrapper.innerHTML=d.join("");var g=baidu.dom.q("item",a.num_wrapper,"a");baidu.array.each(g,function(h){baidu.on(h,"click",function(){a.change_page(h.innerHTML)})})};a.reset_handel=function(c){a.current_page=parseInt(c.current_page);a.total_page=parseInt(c.total_page);a.on_change_page=c.on_change_page;a.update_state();app.log("Pager.reset_handel() me.on_change_page..")};a.show=function(){if(a.display_type=="hide"){a.container.style.display="block";a.display_type="show"}};a.hide=function(){if(a.display_type=="show"){baidu.hide(a.container);a.display_type="hide"}};a.prev_button=b.prev_button;a.next_button=b.next_button;a.num_wrapper=b.num_wrapper;a.container=a.prev_button.parentNode.parentNode;baidu.event.on(a.prev_button,"click",function(){a.prev()});baidu.event.on(a.next_button,"click",function(){a.next()})}Pager.pager_end="app-pager-end";Pager.max=5;function Comment(f,d,a){var c=this;a=a||{};c.container=baidu.g(d);c.data=null;c.need_ok_clear=false;c.get_data=function(g,h){};c.init_html=function(){c.container.innerHTML=baidu.format(['<div class="app-comment-title clearfix">',"<em>#{app_name}的评论</em>",'<span class="app-single-grade app_comment_score"><i data-grade="" style=""></i></span>','<span class="app-comment-num">#{score_num}条评论</span>',f.is_authorized?'<a href="###" class="ico-remove-authorization">解除授权</a>':"","</div>",'<div class="app-comment-list"></div>','<div class="pagination clearfix"></div>','<div class="app-comment-form">','<h4><a name="app_comment"></a>我要评论</h4>',"<table>",'<tr><th>应用打分：</th><td><span class="app-single-grade app-comment-score-picker"><i data-grade="0" class="app-score-0"></i></span><span class="app-score-tip">点击星星打分</span></td></tr>','<tr><th>评价内容：</th><td><textarea class="app-comment-textarea inset-shadow"></textarea></td></tr>','<tr><th>验 证 码 ：</th><td><input type="text" class="app-comment-code inset-shadow"><span class="app-comment-img"></span><span style="display:none;" class="app-comment-img-change">看不清，换一张</span></td></tr>','<tr><th></th><td><button class="app-comment-submit">提交评论</button><span class="app-comment-status"></span></td></tr>',"</div>"].join(""),f);c._score=b("app_comment_score");Comment.set_score(c._score,f.score);c._picker=b("app-comment-score-picker");c._submit=b("app-comment-submit");c._status=b("app-comment-status");c._content=b("app-comment-textarea");c._code=b("app-comment-code");c._form=b("app-comment-form");c._num=b("app-comment-num");c._vimg=b("app-comment-img");c._tip=b("app-score-tip");c._img_change=b("app-comment-img-change");c._pager=b("pagination");c._authorization=b("ico-remove-authorization");if(!f.is_online_app||(!f.is_app_free&&!f.is_paid)){baidu.dom.hide(c._form)}};c.bind_unauthorize=function(){if(c._authorization){baidu.on(c._authorization,"click",function(g){app.authorize.confirm(f.app_id);baidu.event.stop(g)})}};c.set_pager=function(i,g){app.log("Comment.set_pager() current_page ",i," total_page ",g);if(g<=1){return}if(c.pager){c.pager.current_page=parseInt(i);c.pager.total_page=parseInt(g);c.pager.update_state()}else{var h=c._pager;h.innerHTML=['<div class="app_comment_pager_uis"><a class="prev" href="#app_comment">上一页</a>','<span class="item_wrapper">',"</span>",'<a class="next" href="#app_comment">下一页</a></div>'].join("");c.pager=new Pager({prev_button:baidu.q("prev",c._pager,"a")[0],next_button:baidu.q("next",c._pager,"a")[0],num_wrapper:baidu.q("item_wrapper",c._pager,"span")[0]});c.pager.reset_handel({current_page:i,total_page:g,on_change_page:c.change_page})}c.pager.show()};c.show_list=function(){var h=[];function j(k){if(k==0){return" first"}else{if(k==(c.data.data.length-1)){return" last"}else{return""}}}if(c.data.data.length>0){baidu.each(c.data.data,function(k,l){k.time=baidu.date.format(new Date(k.time*1000),"yyyy-MM-dd HH:mm");h.push(baidu.string.format(['<div class="app-comment-item'+j(l)+'">','<div class="app-comment-item-header">','<span class="app-comment-username">#{username}：</span>','<span class="app-single-grade"><i data-grade="#{score}" class="app-score-#{score}"></i></span>','<span class="app-comment-score-tip" data-grade="#{score}"></span>','<span class="app-comment-time">#{time}</span>',"</div>",'<div class="app-comment-content">#{content}</div>',"</div>"].join(""),k))})}else{h.push('<div class="app-comment-item last">'+f.app_name+"目前还没有评论，快来抢沙发吧！</div>")}var i=baidu.dom.q("app-comment-list",c.container,"div")[0];i.innerHTML=h.join("");var g=baidu.q("app-comment-score-tip",c.container,"span");baidu.array.each(g,function(l,k){var m=l.getAttribute("data-grade")-0;m=m>5?5:m;m=m<0?0:m;l.innerHTML=Comment.score_tip[Math.floor(m)]});c._num.innerHTML=c.data.total_count+"条评论";Comment.set_score(c._score,c.data.score)};c.change_page=function(g){c.get_data(g,c.refresh)};c.refresh=function(){app.log("Comment.refresh");c.show_list();c.set_pager(c.data.current_page,Math.ceil(c.data.total_count/Comment.PageSize));setTimeout(function(){if(c._form_open){c.hide_form()}},450);if(c.need_ok_clear){setTimeout(function(){c._content.value="";c._code.value=""},800)}};c.bind=function(){c.bind_unauthorize();c.bind_score_picker();c.bind_submit_button();c.bind_code();c.bind_vimg()};c.bind_score_picker=function(){var g=c._picker;var i=baidu.dom.first(g);var h=false;baidu.event.on(g,"mousemove",function(j){if(!h){j=j||window.event;var k=Math.ceil((j.layerX||j.offsetX||0)/Comment.score_width);if(isNaN(k)||k<0||k>5){k=0}i.className="app-score-"+k;baidu.dom.setAttr(i,"data-grade",k);c._tip.innerHTML=Comment.score_tip[k]}});baidu.event.on(g,"click",function(j){h=!h})};c.bind_submit_button=function(){var g=c._submit;baidu.event.on(g,"click",c.on_submit)};c.getvcode=function(){dal.getvcode(function(g){c._vimg_is_new=true;c._vcode=g;c._vimg.innerHTML='<img src="'+app.apps_domain+"/vcode/genimage?vcode="+g+'" alt="" />';c._code.focus();baidu.show(c._img_change)})};c.bind_code=function(){baidu.event.on(c._code,"focus",function(){if(c._vimg_is_new){}else{c.getvcode()}});baidu.event.on(c._code,"blur",function(){c._vimg_is_new=false});baidu.event.on(c._code,"keydown",function(g){if(baidu.event.get(g).keyCode=="13"){c.on_submit()}})};c.bind_vimg=function(){baidu.event.on(c._vimg,"click",c.getvcode);baidu.event.on(b("app-comment-img-change"),"click",c.getvcode)};c.alert=function(g){baidu.addClass(c._status,"app-comment-error");c._status.innerHTML=g};c.tip=function(g){baidu.removeClass(c._status,"app-comment-error");c._status.innerHTML=g};c.on_submit=function(){var h={appid:f.app_id,score:Comment.get_score(c._picker),content:c._content.value,captcha:c._code.value,vcode:c._vcode};var g=true;if(h.score<1){c.alert(Comment.Msg.score_null);g=false}if(h.content.length>200){c.alert(Comment.Msg.content_overflow);g=false}if(h.captcha==""){c.alert(Comment.Msg.captcha_null);c.getvcode();g=false}if(!g){return}app.log("Comment.submit");app.log(h);dal.submit_comment(h,function(i){if(i.errno==0){c.on_sucess()}else{if(i.errno=="1104"){c.alert(Comment.ErrMsg[i.errno]);c._code.focus();c.getvcode()}else{c.alert("评论失败："+Comment.ErrMsg[i.errno])}}})};c.on_sucess=function(){c.tip(Comment.Msg.sucess);c.need_ok_clear=true;if(c._submit_tip){clearTimeout(c._submit_tip)}c._submit_tip=setTimeout(function(){c.tip("")},3000);setTimeout(function(){c.change_page(1)},500)};c.init=function(){c.init_html();c.bind();c.get_data(1,function(){c.refresh()})};function b(h,g){return baidu.dom.q(h,g?g:c.container)[0]}}Comment.set_score=function(b,c){var a=baidu.dom.first(b);c=Number(c);if(isNaN(c)||c<0||c>5){c=0}baidu.dom.setAttr(a,"data-grade",c);a.style.width=Comment.score_width*c+"px"};Comment.get_score=function(a){return Math.round(parseInt(baidu.getStyle(a.firstChild,"width"))/Comment.score_width)};(function(){var c;var b=function(){clearTimeout(c);c=setTimeout(function(){baidu.each(baidu.q("open-light2"),function(f,d){baidu.dom.removeClass(f,"show-light2")})},5000)};baidu.each(baidu.q("open-light2"),function(f,d){baidu.on(f,"mouseover",function(){clearTimeout(c);baidu.dom.addClass(f,"show-light2");baidu.event.once(f,"mouseout",b)});baidu.event.once(f,"mouseout",b)});function a(d){if(d){if(d.className=="close-light"){screenPool(1,function(){baidu.each(baidu.q("open-light"),function(f){baidu.show(f);if(f.className.indexOf("open-light2")!=-1){baidu.dom.addClass(f,"show-light2")}});b()});baidu.q("header")[0]&&baidu.dom.removeClass(baidu.q("header")[0],"on-suggest");baidu.q("content")[0]&&baidu.dom.removeClass(baidu.q("content")[0],"under-suggest");baidu.q("footer")[0]&&baidu.dom.removeClass(baidu.q("footer")[0],"under-suggest");baidu.dom.addClass(document.body,"hide_his")}else{screenPool(0,function(){baidu.each(baidu.q("open-light"),function(f){baidu.hide(f)})});baidu.q("header")[0]&&baidu.dom.addClass(baidu.q("header")[0],"on-suggest");baidu.q("content")[0]&&baidu.dom.addClass(baidu.q("content")[0],"under-suggest");baidu.q("footer")[0]&&baidu.dom.addClass(baidu.q("footer")[0],"under-suggest");clearTimeout(c)}return false}}window.changeLight=a})();var hidden_arr=[];var screenPool;baidu.g("app-desc")&&hidden_arr.push(baidu.g("app-desc"));baidu.g("RelatedRec")&&hidden_arr.push(baidu.g("RelatedRec"));baidu.g("RecBanner")&&hidden_arr.push(baidu.g("RecBanner"));baidu.q("header")[0]&&hidden_arr.push(baidu.q("header")[0]);baidu.q("content")[0]&&hidden_arr.push(baidu.q("content")[0]);baidu.q("bread-navigation")[0]&&hidden_arr.push(baidu.q("bread-navigation")[0]);baidu.q("footer")[0]&&hidden_arr.push(baidu.q("footer")[0]);baidu.q("fullscreen-showcase-menu")[0]&&hidden_arr.push(baidu.q("fullscreen-showcase-menu")[0]);var shadowTimer;var shadowTimer2;if((baidu.browser.ie==6)||(baidu.browser.ie==7)){screenPool=function(a,b){if(a){baidu.dom.addClass(document.body,"shadow-bg");baidu.each(hidden_arr,function(c){if(c){baidu.dom.addClass(c,"hide-ele")}})}else{baidu.dom.removeClass(document.body,"shadow-bg");baidu.each(hidden_arr,function(c){if(c){baidu.dom.removeClass(c,"hide-ele")}});baidu.dom.removeClass(document.body,"hide_his")}b&&b()}}else{if(baidu.browser.ie==8){screenPool=function(a,b){if(a){baidu.show("OhShadow");baidu.fx.opacity("OhShadow",{duration:1000,from:0,to:1,onafterfinish:function(){b&&b()}})}else{b&&b();baidu.fx.opacity("OhShadow",{duration:1000,from:1,to:0,onafterfinish:function(){baidu.hide("OhShadow");baidu.dom.removeClass(document.body,"hide_his")}})}}}else{screenPool=function(a,b){if(a){baidu.show("OhShadow");clearTimeout(shadowTimer);shadowTimer=setTimeout(function(){baidu.dom.addClass("OhShadow","show")},50);clearTimeout(shadowTimer2);shadowTimer2=setTimeout(function(){b&&b()},800)}else{baidu.dom.removeClass("OhShadow","show");b&&b();clearTimeout(shadowTimer);shadowTimer=setTimeout(function(){baidu.hide("OhShadow");baidu.dom.removeClass(document.body,"hide_his")},1100)}}}}Comment.score_width=10;Comment.score_tip=["","很差","不太好","一般","非常好","极力推荐"];Comment.Msg={sucess:"评论发表成功",score_null:"您忘记打分了",captcha_null:"验证码不能为空",content_overflow:"评论内容不能多于200字符"};Comment.ErrMsg={"-1":"提交失败","1":"未登录","1104":"验证码不正确","1001":"您评论的应用已经被关闭或者已删除"};Comment.PageSize=10;app.history=function(b){var a=document.createElement("iframe");a.id="history_iframe";a.style.display="none";document.body.appendChild(a);baidu.on(a,"load",b);a.src="/static/appweb/html/history.html"};app._evtToFavoSubmit=false;app.add_app_button=function(d,c){if(!d){return null}var b={"-1003":"当前关键词关联的应用超过限制","-1004":"关键词字符长度超过限制","-1005":"您已经添加过这个应用了","1000":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1001":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1002":"很抱歉，您访问的应用已经被关闭或者已删除，请返回查看其他应用","1003":"该应用正在维护"};var a=this;a.button=d;a.appinfo=c;a.add_app=function(f){window.sendShowColl&&window.sendShowColl(f);if(app.is_login()){if(a._add_dialog&&!a._add_dialog.disposed){return}a._add_dialog=app.show_add_dialog(c,{fromShare:f},function(g){if(g.errno=="0"){c.is_added=true;a.update_add_button();app.show_added_ok_tip(f)}else{if(g.errno=="-1005"){c.is_added=true;a.update_add_button()}app.alert(b[g.errno])}});app._addEventToFavoSubmit()}else{app.login(function(){dal.app_info(c.app_id,function(g){a.appinfo=g;if(g.is_added){a.update_add_button();app.alert(b["-1005"])}else{a.add_app(f)}})})}};a.update_add_button=function(){baidu.event.on(a.button,"click",function(f){baidu.event.stop(f);a.add_app()})};a.update_add_button()};(function(){app._addEventToFavoSubmit=function(){if(!app._evtToFavoSubmit){var a=baidu.q("app-tip-add-submit")[0];var b=baidu.q("app-tip-keyword-input")[0];if(a){baidu.on(a,"mousedown",function(){b.value=baidu.trim(b.value.replace(/(,|，)/g,"")).substr(0,30)})}app._evtToFavoSubmit=true}}})();